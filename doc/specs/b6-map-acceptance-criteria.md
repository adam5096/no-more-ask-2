# B6 實況地圖 v1 驗收標準

**版本**: v1.0  
**日期**: 2026-02-02  
**依據**: ORCA Discovery 訪談結果

---

## 功能驗收標準

### 公開圖層 (Landing Page)

- [ ] 未登入用戶可以看到地圖
- [ ] 地圖顯示熱點聚合資料 (區域級別)
- [ ] 熱點以視覺化方式顯示 (圓點/熱力圖)
- [ ] 熱點顯示救援請求數量
- [ ] 熱點顯示平均壓力等級 (顏色深淺)
- [ ] 地圖可縮放、拖移

### 個人圖層 (登入後)

- [ ] 登入用戶可以看到個人圖層
- [ ] 個人圖層顯示「我的救援請求」位置
- [ ] 個人圖層顯示「我收藏的 Helper」位置 (如已公開)
- [ ] 個人圖層與公開圖層正確疊加

### 圖層控制

- [ ] 用戶可以 toggle 開關各圖層
- [ ] 圖層狀態正確持久化 (refresh 後維持)
- [ ] 圖層控制 UI 清楚顯示當前狀態

### Helper 位置隱私

- [ ] Helper 預設公開位置 (Opt-out)
- [ ] Helper 可以關閉位置公開設定
- [ ] 位置關閉後，不出現在其他用戶的地圖上

---

## 設計驗收標準

### 地圖 UI/UX

- [ ] 地圖填滿可用區域，響應式適配
- [ ] 載入中顯示 skeleton/spinner
- [ ] 地圖控制項 (縮放、圖層) 位置合理
- [ ] 熱點 hover 時顯示詳細資訊 tooltip
- [ ] 點擊救援請求 marker 顯示摘要卡片

### 響應式設計

- [ ] 手機版：圖層控制摺疊，點擊展開
- [ ] 桌面版：圖層控制固定顯示
- [ ] 地圖在所有尺寸正常運作

---

## 技術驗收標準

### 前端架構

- [ ] 使用 Leaflet + `@nuxtjs/leaflet` 整合
- [ ] 地圖組件可獨立掛載 (支援 Landing Page 和 Dashboard)
- [ ] 圖層切換不需重新載入整個頁面

### BFF API

- [ ] `GET /api/map/hotspots` 回傳熱點聚合資料
- [ ] `GET /api/map/rescue-requests` 回傳用戶救援請求 (需認證)
- [ ] `GET /api/map/helpers` 回傳公開 Helper 位置 (需認證)
- [ ] `PATCH /api/user/layer-preferences` 更新圖層偏好

### 效能

- [ ] 初始載入 < 3 秒
- [ ] 圖層切換 < 500ms
- [ ] 支援 < 1,000 markers 無明顯 lag

### 資料結構

- [ ] 所有 API 回傳符合 `types/map.ts` 定義
- [ ] 位置資料使用 WGS84 座標系

---

## 不在 v1 範圍

以下功能明確排除，留待 v2：

- ❌ 時間維度聚合 (過去 24hr / 7 天)
- ❌ 類型維度聚合 (緊急 / 預約)
- ❌ 用戶自訂標記點
- ❌ 即時位置追蹤
- ❌ 3D 地圖 / 導航

---

## 驗收流程

1. **開發自檢**：完成功能後對照 checklist 自行驗證
2. **瀏覽器測試**：使用 browser subagent 執行 E2E 驗證
3. **用戶驗收**：與用戶 walkthrough 確認符合預期
